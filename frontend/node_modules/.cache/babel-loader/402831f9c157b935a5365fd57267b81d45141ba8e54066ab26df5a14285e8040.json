{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[network,setNetwork]=useState(\"192.168.1.0/24\");const[profile,setProfile]=useState(\"fast\");const[scanId,setScanId]=useState(null);const[status,setStatus]=useState(\"\");const[result,setResult]=useState(null);const[loading,setLoading]=useState(false);const startScan=async()=>{setLoading(true);setResult(null);try{const res=await axios.post(\"/api/scan/start\",{network,profile});setScanId(res.data.scan_id);setStatus(\"started\");}catch(err){var _err$response,_err$response$data;alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||\"Failed to start scan\");}finally{setLoading(false);}};useEffect(()=>{if(!scanId)return;const interval=setInterval(async()=>{try{const res=await axios.get(\"/api/scan/status/\".concat(scanId));setStatus(res.data.status);if(res.data.status===\"finished\"){clearInterval(interval);const resultRes=await axios.get(\"/api/scan/result/\".concat(scanId));// Handle both backend response shapes gracefully\nconst data=resultRes.data.results||resultRes.data.devices||[];setResult({results:data});}}catch(err){console.error(\"Error fetching scan result:\",err);}},5000);return()=>clearInterval(interval);},[scanId]);return/*#__PURE__*/_jsxs(\"div\",{style:{fontFamily:\"Arial\",padding:\"20px\"},children:[/*#__PURE__*/_jsxs(\"header\",{className:\"bg-gray-900 text-white p-4 text-2xl font-bold shadow\",children:[\"\\uD83D\\uDEE1\\uFE0F IoT Guardian \",/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-400\",children:\"Dashboard\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Scan your local network for vulnerable IoT devices.\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:\"10px\"},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Network CIDR: \"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:network,onChange:e=>setNetwork(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:\"10px\"},children:[/*#__PURE__*/_jsx(\"label\",{children:\"Scan profile: \"}),/*#__PURE__*/_jsxs(\"select\",{value:profile,onChange:e=>setProfile(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"fast\",children:\"Fast\"}),/*#__PURE__*/_jsx(\"option\",{value:\"normal\",children:\"Normal\"}),/*#__PURE__*/_jsx(\"option\",{value:\"deep\",children:\"Deep\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:startScan,disabled:loading,children:loading?\"Starting...\":\"Start Scan\"}),scanId&&/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Scan ID:\"}),\" \",scanId,\" \\u2014 \",/*#__PURE__*/_jsx(\"em\",{children:status})]}),result&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Scan Results\"}),/*#__PURE__*/_jsxs(\"table\",{border:\"1\",cellPadding:\"6\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"IP\"}),/*#__PURE__*/_jsx(\"th\",{children:\"MAC\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Vendor\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Open Ports\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Risk Score\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Recommendation\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:result.results.map((r,i)=>{var _r$risk;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:r.ip}),/*#__PURE__*/_jsx(\"td\",{children:r.mac}),/*#__PURE__*/_jsx(\"td\",{children:r.vendor}),/*#__PURE__*/_jsx(\"td\",{children:Array.isArray(r.open_ports)&&r.open_ports.length>0?r.open_ports.map(p=>{var _p$port,_p$port2;return/*#__PURE__*/_jsxs(\"div\",{children:[(_p$port2=p.port)!==null&&_p$port2!==void 0?_p$port2:p,\" \",p.service?\"(\".concat(p.service,\")\"):\"\"]},(_p$port=p.port)!==null&&_p$port!==void 0?_p$port:\"\".concat(p));}):/*#__PURE__*/_jsx(\"span\",{children:\"\\u2014\"})}),/*#__PURE__*/_jsx(\"td\",{children:(_r$risk=r.risk)===null||_r$risk===void 0?void 0:_r$risk.risk_score}),/*#__PURE__*/_jsx(\"td\",{children:r.recommendation})]},i);})})]})]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","App","network","setNetwork","profile","setProfile","scanId","setScanId","status","setStatus","result","setResult","loading","setLoading","startScan","res","post","data","scan_id","err","_err$response","_err$response$data","alert","response","error","interval","setInterval","get","concat","clearInterval","resultRes","results","devices","console","style","fontFamily","padding","children","className","marginBottom","type","value","onChange","e","target","onClick","disabled","border","cellPadding","map","r","i","_r$risk","ip","mac","vendor","Array","isArray","open_ports","length","p","_p$port","_p$port2","port","service","risk","risk_score","recommendation"],"sources":["/home/ayrton/IoT_Guardian/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nfunction App() {\n  const [network, setNetwork] = useState(\"192.168.1.0/24\");\n  const [profile, setProfile] = useState(\"fast\");\n  const [scanId, setScanId] = useState(null);\n  const [status, setStatus] = useState(\"\");\n  const [result, setResult] = useState(null);\n  const [loading, setLoading] = useState(false);\n\n  const startScan = async () => {\n    setLoading(true);\n    setResult(null);\n    try {\n      const res = await axios.post(\"/api/scan/start\", { network, profile });\n      setScanId(res.data.scan_id);\n      setStatus(\"started\");\n    } catch (err) {\n      alert(err.response?.data?.error || \"Failed to start scan\");\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n  if (!scanId) return;\n\n  const interval = setInterval(async () => {\n    try {\n      const res = await axios.get(`/api/scan/status/${scanId}`);\n      setStatus(res.data.status);\n\n      if (res.data.status === \"finished\") {\n        clearInterval(interval);\n\n        const resultRes = await axios.get(`/api/scan/result/${scanId}`);\n        // Handle both backend response shapes gracefully\n        const data = resultRes.data.results || resultRes.data.devices || [];\n        setResult({ results: data });\n      }\n    } catch (err) {\n      console.error(\"Error fetching scan result:\", err);\n    }\n  }, 5000);\n\n  return () => clearInterval(interval);\n}, [scanId]);\n\n\n  return (\n    <div style={{ fontFamily: \"Arial\", padding: \"20px\" }}>\n      <header className=\"bg-gray-900 text-white p-4 text-2xl font-bold shadow\">\n       üõ°Ô∏è IoT Guardian <span className=\"text-blue-400\">Dashboard</span>\n      </header>\n\n      <p>Scan your local network for vulnerable IoT devices.</p>\n\n      <div style={{ marginBottom: \"10px\" }}>\n        <label>Network CIDR: </label>\n        <input\n          type=\"text\"\n          value={network}\n          onChange={(e) => setNetwork(e.target.value)}\n        />\n      </div>\n\n      <div style={{ marginBottom: \"10px\" }}>\n        <label>Scan profile: </label>\n        <select value={profile} onChange={(e) => setProfile(e.target.value)}>\n          <option value=\"fast\">Fast</option>\n          <option value=\"normal\">Normal</option>\n          <option value=\"deep\">Deep</option>\n        </select>\n      </div>\n\n      <button onClick={startScan} disabled={loading}>\n        {loading ? \"Starting...\" : \"Start Scan\"}\n      </button>\n\n      {scanId && (\n        <p>\n          <strong>Scan ID:</strong> {scanId} ‚Äî <em>{status}</em>\n        </p>\n      )}\n\n      {result && (\n        <div>\n          <h2>Scan Results</h2>\n          <table border=\"1\" cellPadding=\"6\">\n            <thead>\n              <tr>\n                <th>IP</th>\n                <th>MAC</th>\n                <th>Vendor</th>\n                <th>Open Ports</th>\n                <th>Risk Score</th>\n                <th>Recommendation</th>\n              </tr>\n            </thead>\n            <tbody>\n              {result.results.map((r, i) => (\n                <tr key={i}>\n                  <td>{r.ip}</td>\n                  <td>{r.mac}</td>\n                  <td>{r.vendor}</td>\n                  <td>\n                    {Array.isArray(r.open_ports) && r.open_ports.length > 0 ? (\n                      r.open_ports.map((p) => (\n                        <div key={p.port ?? `${p}`}>{p.port ?? p} {p.service ? `(${p.service})` : \"\"}</div>\n                      ))\n                    ) : (\n                      <span>‚Äî</span>\n                    )}\n                  </td>\n\n                  <td>{r.risk?.risk_score}</td>\n                  <td>{r.recommendation}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}